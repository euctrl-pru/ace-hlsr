# High-level revenues, costs, staff and balance sheet data {#sec-high}

```{r load-data}
#libraries

library(tidyverse)
library(dplyr)
library(readxl)
library(here)

source(here("data_source.R"))

#import data
data_raw  <-  read_xlsx(
                        paste0(data_folder,data_file ),
                        # here("data",data_file),
                       sheet = "F_Revenue",
                       range = cell_limits(c(9, 1), c(NA, 4))) %>%
  as_tibble() %>% 
  rename(TYPE = 'Data', TOTAL = 'Grand Total') %>% 
  mutate(across(TYPE, str_replace, 'Sum of ', '')) %>% 
  filter( TYPE != "REVE_DELEGATION", TYPE != "REVE_REVENUE")

#calculate figures for text. Suffix '_f' means formatted figure -- Just an example for you to see how it could be done to avoid copy pasting
total_reve_f <- data_raw  %>% select(TOTAL) %>%  summarise(sum(TOTAL/1000000)) %>% pull() %>% round() %>% 
  format(., nsmall =0 ,big.mark= " ") %>% paste0("\u20AC", ., "M")

ert_reve <- data_raw  %>% select(ERT) %>%  summarise(sum(ERT)) %>% pull() 
ert_reve_charge <- data_raw  %>%  filter(TYPE == 'REVE_CHARGE') %>% select(ERT)  %>% pull() 
ert_reve_charge_perc <- sprintf("%0.1f%%", ert_reve_charge/ert_reve*100) 

trm_reve <- data_raw  %>% select(TRM) %>%  summarise(sum(TRM)) %>% pull() 
trm_reve_charge <- data_raw  %>%  filter(TYPE == 'REVE_CHARGE') %>% select(TRM)  %>% pull() 
trm_reve_charge_perc <- sprintf("%0.1f%%", trm_reve_charge/trm_reve*100) 

trm_reve_apt <- data_raw  %>%  filter(TYPE == 'REVE_AIRPORT') %>% select(TRM)  %>% pull() 
trm_reve_apt_perc <- sprintf("%0.1f%%", trm_reve_apt/trm_reve*100) 

```

##	Revenues and traffic

::: {.content-visible when-format="pdf"}
```{r rev_gt}
#| file: R/hlsr_rev_gtable.R
#| echo: false
#| include: false
```


```{r rev_gt_latex}
#| echo: false
#| results: asis

cat(latex_table_revenues(df = data_table_pdf))
```
:::



```{=latex}
\begin{table}[H]
\centering
\begin{tabularx}{\textwidth}{r r >{\centering\arraybackslash}X r r}

% --- header (HeaderBlue), using literal € ---
\multicolumn{1}{>{\columncolor{HeaderBlue}\color{white}\bfseries}r}{En-route} &
\multicolumn{1}{>{\columncolor{HeaderBlue}\color{white}\bfseries}r}{\%} &
\multicolumn{1}{>{\columncolor{HeaderBlue}\color{white}\bfseries}c}{Gate-togate revenues (€ M)} &
\multicolumn{1}{>{\columncolor{HeaderBlue}\color{white}\bfseries}r}{\%} &
\multicolumn{1}{>{\columncolor{HeaderBlue}\color{white}\bfseries}r}{Terminal} \\

% 1 (Stripe)
\multicolumn{1}{>{\columncolor{Stripe}}r}{9 235} &
\multicolumn{1}{>{\columncolor{Stripe}}r}{95.8\%} &
\multicolumn{1}{>{\columncolor{Stripe}}>{\centering\arraybackslash}X}{Income from charges} &
\multicolumn{1}{>{\columncolor{Stripe}}r}{73.7\%} &
\multicolumn{1}{>{\columncolor{Stripe}}r}{1 742} \\

% 2 (white)
\multicolumn{1}{>{\columncolor{white}}r}{n.a.} &
\multicolumn{1}{>{\columncolor{white}}r}{n.a.} &
\multicolumn{1}{>{\columncolor{white}}>{\centering\arraybackslash}X}{Income from airport operators} &
\multicolumn{1}{>{\columncolor{white}}r}{17.5\%} &
\multicolumn{1}{>{\columncolor{white}}r}{415} \\

% 3 (Stripe)
\multicolumn{1}{>{\columncolor{Stripe}}r}{0.4} &
\multicolumn{1}{>{\columncolor{Stripe}}r}{0\%} &
\multicolumn{1}{>{\columncolor{Stripe}}>{\centering\arraybackslash}X}{Income from the military} &
\multicolumn{1}{>{\columncolor{Stripe}}r}{0.05\%} &
\multicolumn{1}{>{\columncolor{Stripe}}r}{1.1} \\

% 4 (white)
\multicolumn{1}{>{\columncolor{white}}r}{56} &
\multicolumn{1}{>{\columncolor{white}}r}{0.6\%} &
\multicolumn{1}{>{\columncolor{white}}>{\centering\arraybackslash}X}{Income in respect of exempted flights} &
\multicolumn{1}{>{\columncolor{white}}r}{2.2\%} &
\multicolumn{1}{>{\columncolor{white}}r}{52} \\

% 5 (Stripe)
\multicolumn{1}{>{\columncolor{Stripe}}r}{61} &
\multicolumn{1}{>{\columncolor{Stripe}}r}{0.6\%} &
\multicolumn{1}{>{\columncolor{Stripe}}>{\centering\arraybackslash}X}{Income from domestic government} &
\multicolumn{1}{>{\columncolor{Stripe}}r}{3.4\%} &
\multicolumn{1}{>{\columncolor{Stripe}}r}{81} \\

% 6 (white)
\multicolumn{1}{>{\columncolor{white}}r}{216} &
\multicolumn{1}{>{\columncolor{white}}r}{2.2\%} &
\multicolumn{1}{>{\columncolor{white}}>{\centering\arraybackslash}X}{Financial income} &
\multicolumn{1}{>{\columncolor{white}}r}{2.2\%} &
\multicolumn{1}{>{\columncolor{white}}r}{51} \\

% 7 (Stripe)
\multicolumn{1}{>{\columncolor{Stripe}}r}{70} &
\multicolumn{1}{>{\columncolor{Stripe}}r}{0.7\%} &
\multicolumn{1}{>{\columncolor{Stripe}}>{\centering\arraybackslash}X}{Other income (incl.\ exceptional revenue item)} &
\multicolumn{1}{>{\columncolor{Stripe}}r}{0.9\%} &
\multicolumn{1}{>{\columncolor{Stripe}}r}{22} \\

% total (Total)
\multicolumn{1}{>{\columncolor{Total}}r}{9 638} &
\multicolumn{1}{>{\columncolor{Total}}r}{100\%} &
\multicolumn{1}{>{\columncolor{Total}}>{\centering\arraybackslash}X}{} &
\multicolumn{1}{>{\columncolor{Total}}r}{100\%} &
\multicolumn{1}{>{\columncolor{Total}}r}{2 364} \\

\end{tabularx}
\end{table}
```

