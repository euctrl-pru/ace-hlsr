# High-level revenues, costs, staff and balance sheet data {#sec-high}

```{r load-data}
#libraries

library(tidyverse)
library(dplyr)
library(readxl)
library(here)

source(here("data_source.R"))

#import data
data_raw  <-  read_xlsx(
                        paste0(data_folder,data_file ),
                        # here("data",data_file),
                       sheet = "F_Revenue",
                       range = cell_limits(c(9, 1), c(NA, 4))) %>%
  as_tibble() %>% 
  rename(TYPE = 'Data', TOTAL = 'Grand Total') %>% 
  mutate(across(TYPE, str_replace, 'Sum of ', '')) %>% 
  filter( TYPE != "REVE_DELEGATION", TYPE != "REVE_REVENUE")

#calculate figures for text. Suffix '_f' means formatted figure -- Just an example for you to see how it could be done to avoid copy pasting
total_reve_f <- data_raw  %>% select(TOTAL) %>%  summarise(sum(TOTAL/1000000)) %>% pull() %>% round() %>% 
  format(., nsmall =0 ,big.mark= " ") %>% paste0("\u20AC", ., "M")

ert_reve <- data_raw  %>% select(ERT) %>%  summarise(sum(ERT)) %>% pull() 
ert_reve_charge <- data_raw  %>%  filter(TYPE == 'REVE_CHARGE') %>% select(ERT)  %>% pull() 
ert_reve_charge_perc <- sprintf("%0.1f%%", ert_reve_charge/ert_reve*100) 

trm_reve <- data_raw  %>% select(TRM) %>%  summarise(sum(TRM)) %>% pull() 
trm_reve_charge <- data_raw  %>%  filter(TYPE == 'REVE_CHARGE') %>% select(TRM)  %>% pull() 
trm_reve_charge_perc <- sprintf("%0.1f%%", trm_reve_charge/trm_reve*100) 

trm_reve_apt <- data_raw  %>%  filter(TYPE == 'REVE_AIRPORT') %>% select(TRM)  %>% pull() 
trm_reve_apt_perc <- sprintf("%0.1f%%", trm_reve_apt/trm_reve*100) 

```

##	Revenues and traffic

::: {#fig-figure-5-1}
```{r current-ratio}
#| file: R/hlsr_current_ratio.R
#| format:
#|   html:
#|     out.height: "400px"
#|     out.width: "100%"
```

Trends in ANSPs current ratio {{< var doc.year_report_minus5 >}} - {{< var doc.year_report >}}
:::
